<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Files Index</title>
    <style>
        body {
            background-color: black;
            color: white;
            font-family: "Hiragino Kaku Gothic Pro", Meiryo, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
        }
        ul {
            list-style-type: none;
            padding: 0;
        }
        li {
            padding: 8px 0;
        }
        a {
            color: #4da6ff;
            text-decoration: none;
            transition: color 0.2s;
        }
        a:hover {
            color: #80bfff;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>HTML Files Index</h1>
    <ul id="fileList">
        <!-- Files will be listed here by JavaScript -->
    </ul>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // This works on GitHub Pages where we can use a relative path
            const fileList = document.getElementById('fileList');
            
            // First try to get the list from a sitemap (if available)
            fetch('sitemap.xml')
                .then(response => {
                    if (response.ok) return response.text();
                    throw new Error('No sitemap');
                })
                .then(xml => {
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(xml, "text/xml");
                    const urls = xmlDoc.getElementsByTagName("url");
                    
                    for (let url of urls) {
                        const loc = url.getElementsByTagName("loc")[0].textContent;
                        const path = new URL(loc).pathname;
                        if (path.endsWith('.html') && !path.endsWith('index.html')) {
                            addFileToList(path.split('/').pop());
                        }
                    }
                })
                .catch(() => {
                    // If sitemap fails, try to find files manually
                    findFilesRecursively('');
                });
            
            function findFilesRecursively(path) {
                fetch(path + '?no-cache=' + Date.now())
                    .then(response => response.text())
                    .then(html => {
                        // Parse the directory listing HTML
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, "text/html");
                        const links = doc.querySelectorAll('a[href]');
                        
                        links.forEach(link => {
                            const href = link.getAttribute('href');
                            if (href.endsWith('.html') && href !== 'index.html') {
                                addFileToList(href);
                            } else if (!href.startsWith('http') && !href.includes('?') && 
                                      !href.includes('#') && !href.startsWith('../') && 
                                      href !== '/' && !href.endsWith('/')) {
                                // This might be a subdirectory - check recursively
                                findFilesRecursively(href);
                            }
                        });
                    })
                    .catch(error => {
                        console.error('Error finding files:', error);
                        fileList.innerHTML = '<li>Error loading file list. Please check the console.</li>';
                    });
            }
            
            function addFileToList(filename) {
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                
                // Convert filename to title (remove .html and format)
                const title = filename
                    .replace('.html', '')
                    .split(/[-_]/)
                    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                    .join(' ');
                
                link.textContent = title;
                link.href = filename;
                link.target = "_blank";
                
                listItem.appendChild(link);
                fileList.appendChild(listItem);
            }
        });
    </script>
</body>
</html>